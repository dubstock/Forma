<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forma360度店内画像</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>
    /* ボタン共通スタイル */
    .switch-buttons, .zoom-controls {
      position: absolute; display: flex; flex-direction: column; gap: 8px;
      z-index: 10;
    }
    .switch-buttons { top: 20px; right: 20px; }
    .zoom-controls { top: 20px; left: 20px; align-items: flex-start; }
    button {
      padding: 8px 16px; font-size: 16px; border-radius: 12px; border: none;
      cursor: pointer; transition: background 0.2s, color 0.2s;
    }
    .switch-buttons button {
      background: #232323bb; color: #fff;
    }
    .switch-buttons button:hover {
      background: #3e8e41;
    }
    .zoom-controls button {
      background: linear-gradient(90deg, #67d5ffcc, #c3eaffbb);
      color: #205074; font-weight: bold;
      box-shadow: 0 2px 8px #8ed3ff33;
    }
    .zoom-controls button:hover {
      background: linear-gradient(90deg, #b3e3fccc, #c3eaffdd);
      color: #126098;
    }
    .zoom-status {
      margin-top: 6px; min-width: 120px; text-align: center;
      padding: 8px 18px; font-size: 16px; font-weight: bold;
      border-radius: 16px; background: linear-gradient(90deg, #eaf6ffcc 80%, #f3fdffbb);
      color: #205074; box-shadow: 0 2px 8px #a6e4ff26;
      user-select: none;
    }
    html, body { margin: 0; padding: 0; width:100%; height:100%; overflow:hidden; }
    a-scene { width:100%; height:100%; }
  </style>
</head>
<body>
  <!-- 画像切り替えボタン -->
  <div class="switch-buttons">
    <button data-index="0">ファサード</button>
    <button data-index="1">売場1</button>
    <button data-index="2">カウンター前</button>
    <button data-index="3">売場2</button>
    <button data-index="4">催事</button>
  </div>

  <!-- ズームコントロール -->
  <div class="zoom-controls">
    <button id="zoom-in">＋ズームイン</button>
    <button id="zoom-out">－ズームアウト</button>
    <button id="zoom-reset">リセット</button>
    <div id="zoom-status" class="zoom-status">ズーム倍率: 1.00x</div>
  </div>

  <!-- A-Frame シーン -->
  <a-scene>
    <a-sky id="sky" src="images/A1.jpg" rotation="0 -130 0"></a-sky>
    <a-entity id="camera" camera look-controls wasd-controls position="0 1.6 0"></a-entity>
  </a-scene>

  <script>
    // 画像リスト
    const images = ["images/AA1.jpg","images/A1.jpg", "images/B1.jpg", "images/C1.jpg", "images/D1.jpg"];

    // カメラ・FOV設定
    const cam = document.getElementById('camera');
    const zoomStatus = document.getElementById('zoom-status');
    const fovDefault = 80;
    let fov = fovDefault;

    function updateZoomStatus() {
      const factor = (fovDefault / fov).toFixed(2);
      zoomStatus.textContent = `ズーム倍率: ${factor}x`;
    }

    function switchSky(index) {
      document.getElementById('sky').setAttribute('src', images[index]);
    }

    function setFov(delta) {
      fov = Math.min(120, Math.max(30, fov + delta));
      cam.setAttribute('camera', 'fov', fov);
      updateZoomStatus();
    }

    // イベントリスナー
    document.querySelectorAll('.switch-buttons button').forEach(btn => {
      btn.addEventListener('click', () => switchSky(btn.dataset.index));
    });
    document.getElementById('zoom-in').addEventListener('click', () => setFov(-5));
    document.getElementById('zoom-out').addEventListener('click', () => setFov(5));
    document.getElementById('zoom-reset').addEventListener('click', () => {
      fov = fovDefault; cam.setAttribute('camera', 'fov', fov); updateZoomStatus();
    });

    // マウスホイールズーム
    document.querySelector('canvas').addEventListener('wheel', e => {
      e.preventDefault();
      setFov(e.deltaY > 0 ? 5 : -5);
    }, { passive: false });

    // タッチピンチズーム
    let lastDist = null;
    window.addEventListener('touchmove', e => {
      if (e.touches.length === 2) {
        const dx = e.touches[0].clientX - e.touches[1].clientX;
        const dy = e.touches[0].clientY - e.touches[1].clientY;
        const dist = Math.hypot(dx, dy);
        if (lastDist !== null) {
          setFov(dist > lastDist + 5 ? -5 : dist < lastDist - 5 ? 5 : 0);
        }
        lastDist = dist;
        e.preventDefault();
      }
    }, { passive: false });
    window.addEventListener('touchend', () => lastDist = null);

    // 初期設定
    cam.setAttribute('camera', 'fov', fov);
    updateZoomStatus();
  </script>
</body>
</html>

